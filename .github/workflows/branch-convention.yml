name: Convention Branch Naming

on:
  push:
    tags-ignore:
      - "**"
    branches:
      - "**"

jobs:
  check-branch-name:
    runs-on: ubuntu-latest

    steps:
      - name: V√©rifier si la branche respecte la convention de nommage
        run: |
          BRANCH_NAME="${{ github.ref_name }}"

          # üö® Interdit les pushs directs sur 'main'
          if [[ "$BRANCH_NAME" == "main" ]]; then
            echo "‚ùå Erreur : Les pushs directs sur 'main' sont interdits !"
            exit 1
          fi

          # üö® Autoriser 'develop' uniquement via PR
          if [[ "$BRANCH_NAME" == "develop" ]]; then
            echo "‚ö†Ô∏è Attention : Les pushs sur 'develop' sont autoris√©s, mais doivent √™tre valid√©s via une Pull Request."
            exit 0
          fi

          # ‚úÖ V√©rifier que le nom de la branche respecte la convention
          if [[ ! "$BRANCH_NAME" =~ ^(feat|chore|fix|refacto|test)/ ]]; then
            echo "‚ùå Erreur : Le nom de la branche doit commencer par 'feat/', 'fix/', 'chore/', 'refacto/' ou 'test'."
            exit 1
          fi

          echo "‚úÖ Le nom de la branche respecte la convention."
